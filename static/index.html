<!DOCTYPE html>
<html lang="cs">

<head>
    <meta charset="UTF-8">
    <title>Knihy</title>
    <style>
        body {
            font-family: sans-serif;
            margin: 2rem;
        }

        input,
        select {
            margin-bottom: 1rem;
            padding: 0.5rem;
            width: 300px;
        }

        li {
            margin-bottom: 0.5rem;
        }
    </style>
</head>

<body>
    <h1>Knihy</h1>

    <select id="reader">
        <option value="all">Všichni</option>
        <option value="Já">Já</option>
        <option value="Mamka">Mamka</option>
        <option value="Brácha">Brácha</option>
    </select>

    <input type="text" id="search" placeholder="Zadej název knihy nebo autora" />

    <ul id="books"></ul>

    <script>
        async function loadBooks() {
            const res = await fetch("books.json");
            const books = await res.json();
            const ul = document.getElementById("books");
            const input = document.getElementById("search");
            const select = document.getElementById("reader");

            function render() {
                const filterText = input.value.toLowerCase();
                const reader = select.value;
                ul.innerHTML = "";

                books
                    .filter(b =>
                        (b.title.toLowerCase().includes(filterText) || b.author.toLowerCase().includes(filterText)) &&
                        (reader === "all" || b.readers.includes(reader))
                    )
                    .forEach(b => {
                        const li = document.createElement("li");
                        li.innerHTML = `<a href="${b.link}" target="_blank"><strong>${b.title}</strong></a> – ${b.author} (${b.readers.join(", ")})`;
                        ul.appendChild(li);
                    });
            }

            input.addEventListener("input", render);
            select.addEventListener("change", render);
            render();
        }

        loadBooks();
    </script>
</body>

</html>